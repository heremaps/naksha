<mxfile host="Electron" modified="2024-04-26T10:26:35.720Z" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/22.1.2 Chrome/114.0.5735.289 Electron/25.9.4 Safari/537.36" etag="s-6F5SyBxrYyqaiyLplc" version="22.1.2" type="device">
  <diagram name="Page-1" id="c7558073-3199-34d8-9f00-42111426c3f3">
    <mxGraphModel dx="2105" dy="1001" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="4681" pageHeight="3300" background="none" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="1qYccRmLHqD2nOXxJYSw-157" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="1qYccRmLHqD2nOXxJYSw-96" target="1qYccRmLHqD2nOXxJYSw-265" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2874" y="1670" as="sourcePoint" />
            <mxPoint x="3135.9469026548672" y="1722.6379310344828" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2854" y="1700" />
              <mxPoint x="3240" y="1700" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-158" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="1qYccRmLHqD2nOXxJYSw-122" target="1qYccRmLHqD2nOXxJYSw-265" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="3204.9655172413795" y="1697.5" as="targetPoint" />
            <mxPoint x="3138.9355000000005" y="1591.89" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="3240" y="1680" />
              <mxPoint x="3240" y="1680" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-233" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="1qYccRmLHqD2nOXxJYSw-134" target="1qYccRmLHqD2nOXxJYSw-265" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="3274" y="1727.4655172413795" as="targetPoint" />
            <Array as="points">
              <mxPoint x="3424" y="1450" />
              <mxPoint x="3424" y="1727" />
              <mxPoint x="3240" y="1727" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-202" value="TEMPLATE" style="html=1;shadow=0;dashed=0;shape=mxgraph.bootstrap.rrect;rSize=5;strokeColor=#999999;strokeWidth=1;fillColor=#FFFFFF;fontColor=#6C767D;whiteSpace=wrap;align=left;verticalAlign=middle;spacingLeft=10;fontSize=14;spacing=10;" parent="1" vertex="1">
          <mxGeometry x="1175" y="2814" width="105" height="60" as="geometry" />
        </mxCell>
        <mxCell id="ocHGO5GNn9pmyrgSXm_p-51" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;" parent="1" source="1qYccRmLHqD2nOXxJYSw-123" target="1qYccRmLHqD2nOXxJYSw-134" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="3404" y="1453" />
              <mxPoint x="3404" y="1410" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="veuHkW8nXqJATqobilVs-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="veuHkW8nXqJATqobilVs-14" target="ocHGO5GNn9pmyrgSXm_p-52" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="veuHkW8nXqJATqobilVs-28" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;" parent="1" source="veuHkW8nXqJATqobilVs-16" target="1qYccRmLHqD2nOXxJYSw-100" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2250" y="2202" />
              <mxPoint x="2250" y="2202" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="bkxJdcmxccUSYZqPa4WW-68" value="&amp;lt; part of properties [@ns:com:here:xyz] &amp;gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="veuHkW8nXqJATqobilVs-28" vertex="1" connectable="0">
          <mxGeometry x="-0.5323" y="3" relative="1" as="geometry">
            <mxPoint x="-186" y="-9" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="2r80sXf8cgRXmCBXb2kK-236" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="2994" y="670" width="360" height="326" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-295" value="NakshaContext" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#fff2cc;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=#d6b656;" parent="2r80sXf8cgRXmCBXb2kK-236" vertex="1">
          <mxGeometry y="170" width="360" height="156" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-296" value="+ static currentContext() : NakshaContext" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-295" vertex="1">
          <mxGeometry y="26" width="360" height="26" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-297" value="+ getStreamId() : String" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-295" vertex="1">
          <mxGeometry y="52" width="360" height="26" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-298" value="+ getAppId() : String" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-295" vertex="1">
          <mxGeometry y="78" width="360" height="26" as="geometry" />
        </mxCell>
        <mxCell id="2r80sXf8cgRXmCBXb2kK-10" value="+ getAuthor() : String?" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-295" vertex="1">
          <mxGeometry y="104" width="360" height="26" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-299" value="+ getUserAccessRights() : ?" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-295" vertex="1">
          <mxGeometry y="130" width="360" height="26" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-300" value="The Naksha context is bound to every thread in Naksha and whenever a new thread is forked, the context is shared by the two threads. When a thread is idle or new, it runs with root priviledges and drops them as soon as it executes some task.&lt;br&gt;The context is generated for every incoming requests from the JWT token, and for internal triggers using the trigger source configuration, which must have some rights attached." style="html=1;shadow=0;dashed=0;shape=mxgraph.bootstrap.rrect;rSize=5;strokeColor=#999999;strokeWidth=1;fillColor=#FFFFFF;fontColor=#6C767D;whiteSpace=wrap;align=left;verticalAlign=middle;spacingLeft=10;fontSize=14;spacing=10;" parent="2r80sXf8cgRXmCBXb2kK-236" vertex="1">
          <mxGeometry width="360" height="170" as="geometry" />
        </mxCell>
        <mxCell id="2r80sXf8cgRXmCBXb2kK-262" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="1qYccRmLHqD2nOXxJYSw-180" target="1qYccRmLHqD2nOXxJYSw-151" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-151" value="UniMapTxComment" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#fff2cc;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="4294" y="2514" width="240" height="130" as="geometry" />
        </mxCell>
        <mxCell id="2r80sXf8cgRXmCBXb2kK-260" value="+ id: String" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-151" vertex="1">
          <mxGeometry y="26" width="240" height="26" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-152" value="+ message: String" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-151" vertex="1">
          <mxGeometry y="52" width="240" height="26" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-154" value="+ object: Object" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-151" vertex="1">
          <mxGeometry y="78" width="240" height="26" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-153" value="+ attachment: byte[]" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-151" vertex="1">
          <mxGeometry y="104" width="240" height="26" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-190" value="A message is some arbitrary notification added by the client. The &lt;b&gt;id&lt;/b&gt; is some arbitrary identifier selected by the application." style="html=1;shadow=0;dashed=0;shape=mxgraph.bootstrap.rrect;rSize=5;strokeColor=#999999;strokeWidth=1;fillColor=#FFFFFF;fontColor=#6C767D;whiteSpace=wrap;align=left;verticalAlign=middle;spacingLeft=10;fontSize=14;spacing=10;" parent="1" vertex="1">
          <mxGeometry x="4294" y="2644" width="240" height="88" as="geometry" />
        </mxCell>
        <mxCell id="2r80sXf8cgRXmCBXb2kK-264" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="3844" y="2480" width="400" height="520" as="geometry" />
        </mxCell>
        <UserObject label="UniMapTx" tooltip="" id="1qYccRmLHqD2nOXxJYSw-138">
          <mxCell style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#fff2cc;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=#d6b656;" parent="2r80sXf8cgRXmCBXb2kK-264" vertex="1">
            <mxGeometry width="300" height="182" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="2r80sXf8cgRXmCBXb2kK-255" value="+ ts: long" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-138" vertex="1">
          <mxGeometry y="26" width="300" height="26" as="geometry" />
        </mxCell>
        <mxCell id="2r80sXf8cgRXmCBXb2kK-256" value="+ txn: String" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-138" vertex="1">
          <mxGeometry y="52" width="300" height="26" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-179" value="+ seqNumber: long = 0" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-138" vertex="1">
          <mxGeometry y="78" width="300" height="26" as="geometry" />
        </mxCell>
        <mxCell id="2r80sXf8cgRXmCBXb2kK-257" value="+ seqTs: long = 0" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-138" vertex="1">
          <mxGeometry y="104" width="300" height="26" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-180" value="+ comments: Map&amp;lt;String, UniMapTxComment&amp;gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-138" vertex="1">
          <mxGeometry y="130" width="300" height="26" as="geometry" />
        </mxCell>
        <mxCell id="2r80sXf8cgRXmCBXb2kK-258" value="+ collections: Map&amp;lt;String, List&amp;lt;String&amp;gt;&amp;gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-138" vertex="1">
          <mxGeometry y="156" width="300" height="26" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-184" value="All transactions generate signals. Each signal provides an information about what happend as part of a transaction. All signals of the same transaction will have the same &quot;&lt;b&gt;txn&lt;/b&gt;&quot; (transaction number), found as well in the &lt;i&gt;XyzNamespace&lt;/i&gt;.&lt;br&gt;&lt;br&gt;The &lt;b&gt;seqNumber&lt;/b&gt;&amp;nbsp;and &lt;b&gt;seqTs&lt;/b&gt; can be &lt;i&gt;null&lt;/i&gt;, if the transaction is not yet ready for publication (the visibility is not guaranteed).&amp;nbsp;&lt;br&gt;&lt;br&gt;The storage must guarantee that all transactions eventually have a unique &lt;b&gt;seqNumber&lt;/b&gt;&amp;nbsp;and there must be no holes in it, so the storage must guarantee that there is 1, 2, 3, 4 aso.. This is used for subscriptions and replaying.&lt;br&gt;&lt;br&gt;The &lt;b&gt;collections&lt;/b&gt; are a map between the collection-id and a list of actions that have been done to the collection (&lt;i&gt;MODIFY_FEATURES&lt;/i&gt;, &lt;i style=&quot;&quot;&gt;CREATE_COLLECTION&lt;/i&gt;, UPDATE_COLLECTION, DROP_COLLECTION, ...)" style="html=1;shadow=0;dashed=0;shape=mxgraph.bootstrap.rrect;rSize=5;strokeColor=#999999;strokeWidth=1;fillColor=#FFFFFF;fontColor=#6C767D;whiteSpace=wrap;align=left;verticalAlign=middle;spacingLeft=10;fontSize=14;spacing=10;" parent="2r80sXf8cgRXmCBXb2kK-264" vertex="1">
          <mxGeometry y="182" width="400" height="338" as="geometry" />
        </mxCell>
        <mxCell id="2r80sXf8cgRXmCBXb2kK-282" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="2724" y="1032" width="250" height="142" as="geometry" />
        </mxCell>
        <mxCell id="ocHGO5GNn9pmyrgSXm_p-52" value="Config" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#f8cecc;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=#b85450;" parent="2r80sXf8cgRXmCBXb2kK-282" vertex="1">
          <mxGeometry width="250" height="50" as="geometry" />
        </mxCell>
        <mxCell id="ocHGO5GNn9pmyrgSXm_p-53" value="+ trustedKeys(): List&amp;lt;KeyDetails&amp;gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="ocHGO5GNn9pmyrgSXm_p-52" vertex="1">
          <mxGeometry y="26" width="250" height="24" as="geometry" />
        </mxCell>
        <mxCell id="ocHGO5GNn9pmyrgSXm_p-60" value="The Naksha service configuration. Allows to add JWT keys that are trusted for JWT token verification." style="html=1;shadow=0;dashed=0;shape=mxgraph.bootstrap.rrect;rSize=5;strokeColor=#999999;strokeWidth=1;fillColor=#FFFFFF;fontColor=#6C767D;whiteSpace=wrap;align=left;verticalAlign=middle;spacingLeft=10;fontSize=14;spacing=10;" parent="2r80sXf8cgRXmCBXb2kK-282" vertex="1">
          <mxGeometry y="50" width="250" height="92" as="geometry" />
        </mxCell>
        <mxCell id="2r80sXf8cgRXmCBXb2kK-284" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="1qYccRmLHqD2nOXxJYSw-290" target="1qYccRmLHqD2nOXxJYSw-239" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2614" y="1005" />
              <mxPoint x="2614" y="1520" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="2r80sXf8cgRXmCBXb2kK-312" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="3814" y="1440" width="750" height="290" as="geometry" />
        </mxCell>
        <mxCell id="veuHkW8nXqJATqobilVs-67" value="GUID" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#dae8fc;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=#6c8ebf;container=0;" parent="2r80sXf8cgRXmCBXb2kK-312" vertex="1">
          <mxGeometry x="520" width="230" height="104" as="geometry" />
        </mxCell>
        <mxCell id="veuHkW8nXqJATqobilVs-68" value="+ storageId: String" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="veuHkW8nXqJATqobilVs-67" vertex="1">
          <mxGeometry y="26" width="230" height="26" as="geometry" />
        </mxCell>
        <mxCell id="veuHkW8nXqJATqobilVs-69" value="+ collectionId: String" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="veuHkW8nXqJATqobilVs-67" vertex="1">
          <mxGeometry y="52" width="230" height="26" as="geometry" />
        </mxCell>
        <mxCell id="2r80sXf8cgRXmCBXb2kK-311" value="+ parts: String[]" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="veuHkW8nXqJATqobilVs-67" vertex="1">
          <mxGeometry y="78" width="230" height="26" as="geometry" />
        </mxCell>
        <mxCell id="veuHkW8nXqJATqobilVs-70" value="All features within Naksha do have an audit-log. It is possible to refer to any specific state of a feature using a GUID. Note that in older Naksha versions a UUID was used for this purpose. Naksha will be able to detect this and handle it accordingly.&amp;nbsp;The GUID is encoded like:&lt;br&gt;&lt;br&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;{&lt;/span&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;storageId&lt;/b&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;}:{&lt;/span&gt;&lt;b style=&quot;background-color: initial;&quot;&gt;collectionId&lt;/b&gt;}:&lt;b&gt;...&lt;/b&gt;&lt;br&gt;&lt;br&gt;The &lt;b&gt;storageId&lt;/b&gt; and &lt;b&gt;collectionId&lt;/b&gt; are the values shared by Naksha and the storage. For transactions the&amp;nbsp;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;collectionId&lt;/b&gt;&amp;nbsp;must be&amp;nbsp;&lt;i style=&quot;border-color: var(--border-color);&quot;&gt;&quot;naksha_txn&quot;&lt;/i&gt;. The default Naksha PostgreSQL implementation will have the following layout:&lt;br&gt;&lt;br&gt;{&lt;b style=&quot;border-color: var(--border-color); background-color: initial;&quot;&gt;storageId&lt;/b&gt;&lt;span style=&quot;border-color: var(--border-color); background-color: initial;&quot;&gt;}:{&lt;/span&gt;&lt;b style=&quot;border-color: var(--border-color); background-color: initial;&quot;&gt;collectionId&lt;/b&gt;}:{&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;YYYY}&lt;/b&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;:&lt;/span&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;{MM}&lt;/b&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;:&lt;/span&gt;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;DD&lt;/b&gt;}:{&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;id&lt;/b&gt;}&lt;br&gt;&lt;br&gt;For transaction the id will be transaction-number (txn), while for features within a collection it will be the value of the column i, so the unique row identifier." style="html=1;shadow=0;dashed=0;shape=mxgraph.bootstrap.rrect;rSize=5;strokeColor=#999999;strokeWidth=1;fillColor=#FFFFFF;fontColor=#6C767D;whiteSpace=wrap;align=left;verticalAlign=middle;spacingLeft=10;fontSize=14;spacing=10;container=0;" parent="2r80sXf8cgRXmCBXb2kK-312" vertex="1">
          <mxGeometry width="520" height="290" as="geometry" />
        </mxCell>
        <mxCell id="bkxJdcmxccUSYZqPa4WW-49" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="1qYccRmLHqD2nOXxJYSw-100" target="bkxJdcmxccUSYZqPa4WW-42" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="3754" y="2302" />
              <mxPoint x="3754" y="2302" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="bkxJdcmxccUSYZqPa4WW-82" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="bkxJdcmxccUSYZqPa4WW-81" target="1qYccRmLHqD2nOXxJYSw-239" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2614" y="1031" />
              <mxPoint x="2614" y="1520" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="bkxJdcmxccUSYZqPa4WW-83" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="2r80sXf8cgRXmCBXb2kK-1" target="1qYccRmLHqD2nOXxJYSw-239" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2614" y="1057" />
              <mxPoint x="2614" y="1520" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="bkxJdcmxccUSYZqPa4WW-84" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="1qYccRmLHqD2nOXxJYSw-293" target="1qYccRmLHqD2nOXxJYSw-239" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2614" y="1083" />
              <mxPoint x="2614" y="1520" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="ji72XSmRw8APm09SylYo-136" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="3780.88" y="2260" width="446.25" height="166" as="geometry" />
        </mxCell>
        <mxCell id="bkxJdcmxccUSYZqPa4WW-42" value="XyzFeature" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#fff2cc;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=#d6b656;container=0;movable=1;resizable=1;rotatable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="ji72XSmRw8APm09SylYo-136" vertex="1">
          <mxGeometry width="446.25" height="108" as="geometry" />
        </mxCell>
        <mxCell id="bkxJdcmxccUSYZqPa4WW-43" value="+ id : String" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="bkxJdcmxccUSYZqPa4WW-42" vertex="1">
          <mxGeometry y="26" width="446.25" height="26" as="geometry" />
        </mxCell>
        <mxCell id="bkxJdcmxccUSYZqPa4WW-44" value="+ geometry : XyzGeometry" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="bkxJdcmxccUSYZqPa4WW-42" vertex="1">
          <mxGeometry y="52" width="446.25" height="28" as="geometry" />
        </mxCell>
        <mxCell id="bkxJdcmxccUSYZqPa4WW-45" value="+ properties : XyzProperties" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="bkxJdcmxccUSYZqPa4WW-42" vertex="1">
          <mxGeometry y="80" width="446.25" height="28" as="geometry" />
        </mxCell>
        <mxCell id="bkxJdcmxccUSYZqPa4WW-46" value="The base type of all features that Naksha can process. Features are stored within the storages." style="html=1;shadow=0;dashed=0;shape=mxgraph.bootstrap.rrect;rSize=5;strokeColor=#999999;strokeWidth=1;fillColor=#FFFFFF;fontColor=#6C767D;whiteSpace=wrap;align=left;verticalAlign=middle;spacingLeft=10;fontSize=14;spacing=10;" parent="ji72XSmRw8APm09SylYo-136" vertex="1">
          <mxGeometry y="108" width="446.25" height="58" as="geometry" />
        </mxCell>
        <mxCell id="ocHGO5GNn9pmyrgSXm_p-11" value="A storage is internally represented by a single instance that grants access to a storage instance.&lt;br&gt;&lt;br&gt;Any plugin implementing the&amp;nbsp;&lt;i style=&quot;border-color: var(--border-color);&quot;&gt;IStorage&lt;/i&gt;&amp;nbsp;interface represents some data-sink and comes with an implementation that grants access to the data. The storage normally is a singleton that opens many sessions, each representing an individual connection to the storage.&lt;br&gt;" style="html=1;shadow=0;dashed=0;shape=mxgraph.bootstrap.rrect;rSize=5;strokeColor=#999999;strokeWidth=1;fillColor=#FFFFFF;fontColor=#6C767D;whiteSpace=wrap;align=left;verticalAlign=middle;spacingLeft=10;fontSize=14;spacing=10;" parent="1" vertex="1">
          <mxGeometry x="2680" y="1320" width="374" height="180" as="geometry" />
        </mxCell>
        <mxCell id="2efq71ZKfL60kGu9dnVV-3" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="3104" y="1060" width="272" height="431.5" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-122" value="EventHandler : Plugin&amp;lt;IEventHandler&amp;gt;" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#fff2cc;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=#d6b656;" parent="2efq71ZKfL60kGu9dnVV-3" vertex="1">
          <mxGeometry y="353.5" width="271.5" height="78" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-123" value="+ extensionId: String" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-122" vertex="1">
          <mxGeometry y="26" width="271.5" height="26" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-124" value="+ active: boolean" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-122" vertex="1">
          <mxGeometry y="52" width="271.5" height="26" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-209" value="An event-handler is a configured plugin using some code to perform a specific action in an event-pipeline. Actually, this means binding a concrete code (e.g. business logic) with some arbitrary configuration information provided in the &lt;b&gt;properties&lt;/b&gt;.&lt;br&gt;An event-handler can be executed as extension, so as dedicated process, deployed independently. In that case the &lt;b&gt;extensionId&lt;/b&gt; refers to extension." style="html=1;shadow=0;dashed=0;shape=mxgraph.bootstrap.rrect;rSize=5;strokeColor=#999999;strokeWidth=1;fillColor=#FFFFFF;fontColor=#6C767D;whiteSpace=wrap;align=left;verticalAlign=middle;spacingLeft=10;fontSize=14;spacing=10;" parent="2efq71ZKfL60kGu9dnVV-3" vertex="1">
          <mxGeometry x="-2" y="156" width="272" height="197.5" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-235" value="&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;IEventHandler&lt;/span&gt;" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#d5e8d4;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=#82b366;" parent="2efq71ZKfL60kGu9dnVV-3" vertex="1">
          <mxGeometry y="104" width="270" height="52" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-236" value="+ processEvent( Event ) : Result" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-235" vertex="1">
          <mxGeometry y="26" width="270" height="26" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-270" value="&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;Event&lt;/span&gt;" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#fff2cc;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=#d6b656;" parent="2efq71ZKfL60kGu9dnVV-3" vertex="1">
          <mxGeometry width="270" height="104" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-272" value="+ request : Request" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-270" vertex="1">
          <mxGeometry y="26" width="270" height="26" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-271" value="+ sendUpstream() : Result" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-270" vertex="1">
          <mxGeometry y="52" width="270" height="26" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-273" value="+ sendUpstream(Request) : Result" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-270" vertex="1">
          <mxGeometry y="78" width="270" height="26" as="geometry" />
        </mxCell>
        <mxCell id="2efq71ZKfL60kGu9dnVV-20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="2efq71ZKfL60kGu9dnVV-10" target="1qYccRmLHqD2nOXxJYSw-100" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="2efq71ZKfL60kGu9dnVV-10" value="NakCollection" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#d5e8d4;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=#82b366;container=0;movable=1;resizable=1;rotatable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="1" vertex="1">
          <mxGeometry x="2470" y="2020" width="320" height="52" as="geometry" />
        </mxCell>
        <mxCell id="C_nnIdQDxCc23Knee7Er-184" value="-----&amp;lt;&amp;nbsp;&lt;b&gt;architecture_base.drawio &lt;/b&gt;&amp;gt;-----" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="2efq71ZKfL60kGu9dnVV-10" vertex="1">
          <mxGeometry y="26" width="320" height="26" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-196" value="The base of all features that Naksha uses internally for configuration and management. Naksha allows to organise admin-features in &lt;b&gt;domains&lt;/b&gt;, owned by companies or other entities and within these &lt;b&gt;domains&lt;/b&gt;, to sub-organise the features in &lt;b&gt;catalogs&lt;/b&gt;. Individual access rights can be granted based upon these &lt;b&gt;domains&lt;/b&gt;&amp;nbsp;and &lt;b&gt;catalogs&lt;/b&gt;. Additionally,&amp;nbsp;&lt;b&gt;tags&lt;/b&gt; can be used to manage rights on individual features.&lt;br&gt;&lt;br&gt;Unorganised admin-features will not have a&amp;nbsp;&lt;b&gt;domain&lt;/b&gt; and within a &lt;b&gt;domain&lt;/b&gt;, the &lt;b&gt;catalog&lt;/b&gt; is as well optional. Therefore, the value &lt;i&gt;null&lt;/i&gt; does mean &lt;i&gt;undefined&lt;/i&gt; and should be treated the same. When serializing, do not serialize &lt;b&gt;domain&lt;/b&gt; or &lt;b&gt;catalog&lt;/b&gt;, when being &lt;i&gt;null&lt;/i&gt;." style="html=1;shadow=0;dashed=0;shape=mxgraph.bootstrap.rrect;rSize=5;strokeColor=#999999;strokeWidth=1;fillColor=#FFFFFF;fontColor=#6C767D;whiteSpace=wrap;align=left;verticalAlign=middle;spacingLeft=10;fontSize=14;spacing=10;" parent="1" vertex="1">
          <mxGeometry x="3295" y="2032" width="470" height="210" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-100" value="NakshaFeature" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#fff2cc;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="3129" y="2242" width="270" height="134" as="geometry" />
        </mxCell>
        <mxCell id="_tfUb8YstEa6cr3ThHX8-7" value="+ domain : String?" style="text;strokeColor=#b85450;fillColor=#f8cecc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-100" vertex="1">
          <mxGeometry y="26" width="270" height="28" as="geometry" />
        </mxCell>
        <mxCell id="_tfUb8YstEa6cr3ThHX8-6" value="+ catalog : String?" style="text;strokeColor=#b85450;fillColor=#f8cecc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-100" vertex="1">
          <mxGeometry y="54" width="270" height="28" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-119" value="+ title : String?" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-100" vertex="1">
          <mxGeometry y="82" width="270" height="26" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-305" value="+ description : String?" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-100" vertex="1">
          <mxGeometry y="108" width="270" height="26" as="geometry" />
        </mxCell>
        <mxCell id="2efq71ZKfL60kGu9dnVV-23" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="1qYccRmLHqD2nOXxJYSw-108" target="1qYccRmLHqD2nOXxJYSw-100" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-108" value="EventTarget" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#fff2cc;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;movable=1;resizable=1;rotatable=1;deletable=1;editable=1;locked=0;connectable=1;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="3125" y="2460" width="279" height="81.07" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-109" value="+ eventHandlers : List&amp;lt;String&amp;gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=1;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;movable=1;resizable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="1qYccRmLHqD2nOXxJYSw-108" vertex="1">
          <mxGeometry y="26" width="279" height="25.07" as="geometry" />
        </mxCell>
        <mxCell id="veuHkW8nXqJATqobilVs-124" value="+ context: NakshaContext" style="text;strokeColor=#82b366;fillColor=#d5e8d4;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-108" vertex="1">
          <mxGeometry y="51.07" width="279" height="30" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-199" value="An event target is a virtual event sink that can receive events (notifications and requests).&lt;br&gt;&lt;br&gt;To process any events a&amp;nbsp;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;&lt;i style=&quot;border-color: var(--border-color);&quot;&gt;NakshaContext&lt;/i&gt;&lt;/b&gt;&amp;nbsp;is needed. Therefore, event targets support to define a permanent token, which will be used internally to create the &lt;i&gt;&lt;b&gt;NakshaContext&lt;/b&gt;&lt;/i&gt;, when the event source is an internal one (for example a timer or a new transaction in a storage)." style="html=1;shadow=0;dashed=0;shape=mxgraph.bootstrap.rrect;rSize=5;strokeColor=#999999;strokeWidth=1;fillColor=#FFFFFF;fontColor=#6C767D;whiteSpace=wrap;align=left;verticalAlign=middle;spacingLeft=10;fontSize=14;spacing=10;" parent="1" vertex="1">
          <mxGeometry x="3404" y="2460" width="330" height="176.93" as="geometry" />
        </mxCell>
        <mxCell id="2efq71ZKfL60kGu9dnVV-27" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="1qYccRmLHqD2nOXxJYSw-118" target="1qYccRmLHqD2nOXxJYSw-108" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-118" value="Space" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#fff2cc;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="3264" y="3000" width="140" height="54" as="geometry" />
        </mxCell>
        <mxCell id="ocHGO5GNn9pmyrgSXm_p-14" value="A space is a receiver of requests created by clients. This is done via REST, Websockets or any other public API.&lt;br&gt;&lt;br&gt;The token needed for the context to process requests is provided by the client." style="html=1;shadow=0;dashed=0;shape=mxgraph.bootstrap.rrect;rSize=5;strokeColor=#999999;strokeWidth=1;fillColor=#FFFFFF;fontColor=#6C767D;whiteSpace=wrap;align=left;verticalAlign=middle;spacingLeft=10;fontSize=14;spacing=10;" parent="1" vertex="1">
          <mxGeometry x="3264" y="3054" width="305" height="138" as="geometry" />
        </mxCell>
        <mxCell id="2efq71ZKfL60kGu9dnVV-22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="1qYccRmLHqD2nOXxJYSw-210" target="1qYccRmLHqD2nOXxJYSw-100" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2844" y="2309" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-210" value="SubscriptionState" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;container=0;" parent="1" vertex="1">
          <mxGeometry x="2657" y="2481.07" width="287" height="156" as="geometry" />
        </mxCell>
        <mxCell id="ji72XSmRw8APm09SylYo-50" value="+ callCount: long = 0" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-210" vertex="1">
          <mxGeometry y="26" width="287" height="26" as="geometry" />
        </mxCell>
        <mxCell id="ji72XSmRw8APm09SylYo-37" value="+ errCount: long = 0" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-210" vertex="1">
          <mxGeometry y="52" width="287" height="26" as="geometry" />
        </mxCell>
        <mxCell id="ji72XSmRw8APm09SylYo-11" value="+ lastError: ErrorResult?" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-210" vertex="1">
          <mxGeometry y="78" width="287" height="26" as="geometry" />
        </mxCell>
        <mxCell id="ocHGO5GNn9pmyrgSXm_p-12" value="+ handlerStates: Map&amp;lt;String, Object?&amp;gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-210" vertex="1">
          <mxGeometry y="104" width="287" height="26" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-306" value="+ seqNumber: long = 0" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-210" vertex="1">
          <mxGeometry y="130" width="287" height="26" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-219" value="Naksha does guarantee subscription notifications, therefore every event-handler of the subscription may store individual state data in the &lt;b&gt;handlerStates&lt;/b&gt; map. The key in that map is the unique identifier of the handler, the value an arbitrary object managed by the handler. The concept behind subscriptions is that they only have one final handler, that eventually processes the transaction event. It is not recommended to add multiple final handlers to the same subscription, because this can lead to data and/or event loss.&lt;br&gt;&lt;br&gt;The subscription state is attached to the &lt;b&gt;&lt;i&gt;SubscriptionNotification&lt;/i&gt;&lt;/b&gt; and Naksha has an own storage for subscriptions states. Handlers are allowed to perform state saves, if needed (partial state saves).&lt;br&gt;&lt;br&gt;If the subscription pipeline returns a &lt;b&gt;&lt;i&gt;NotificationSuccessResult&lt;/i&gt;&lt;/b&gt; the Observer sending the notification will set the &lt;b&gt;seqNumber&lt;/b&gt;&amp;nbsp;of the state either to the one provided in the result or, if the result has no &lt;i&gt;&lt;b&gt;seqNumber&lt;/b&gt;&lt;/i&gt; set (&lt;i&gt;null&lt;/i&gt;), to the one of the last transaction being part of the processed&amp;nbsp;&lt;b style=&quot;font-style: italic;&quot;&gt;SubscriptionNotification&lt;/b&gt;.&amp;nbsp;It will increment the &lt;b&gt;&lt;i&gt;callCount&lt;/i&gt;&lt;/b&gt;, set &lt;b&gt;&lt;i&gt;lastError&lt;/i&gt;&lt;/b&gt; to &lt;i&gt;null&lt;/i&gt;, and the &lt;b&gt;&lt;i&gt;errCount&lt;/i&gt;&lt;/b&gt; to zero, then updating the subscription state atomically. By returning a specific &lt;b&gt;&lt;i&gt;seqNumber&lt;/i&gt;&lt;/b&gt;&amp;nbsp;in the result, the handlers can prevent that unprocessed transactions are skipped.&lt;br&gt;&lt;br&gt;If the pipeline returns an &lt;b&gt;&lt;i&gt;ErrorResult&lt;/i&gt;&lt;/b&gt; the Observer will increment the &lt;b&gt;&lt;i&gt;callCount&lt;/i&gt;&lt;/b&gt;, set the &lt;b&gt;&lt;i&gt;lastError&lt;/i&gt;&lt;/b&gt; to the error returned and increment the&amp;nbsp;&lt;b style=&quot;border-color: var(--border-color);&quot;&gt;&lt;i style=&quot;border-color: var(--border-color);&quot;&gt;errCount&lt;/i&gt;&lt;/b&gt;&amp;nbsp;(which decides about the wait time before firing the same notification again). Then it will update the &lt;b&gt;&lt;i&gt;SubscriptionState&lt;/i&gt;&lt;/b&gt;. The &lt;b&gt;&lt;i&gt;S&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;ubscriptionNotification&lt;/span&gt;&lt;/span&gt;&lt;/i&gt;&lt;/b&gt;&amp;nbsp;is fired again later, the time delta is dependent on the &lt;b&gt;&lt;i&gt;errCount&lt;/i&gt;&lt;/b&gt;.&lt;br&gt;&lt;br&gt;Finally the Observer will continue waiting for more transaction with a &lt;i style=&quot;font-weight: bold;&quot;&gt;seqNumber &lt;/i&gt;greater than the current &lt;i style=&quot;font-weight: bold;&quot;&gt;seqNumber&lt;/i&gt;. The &lt;b&gt;seqNumber&lt;/b&gt;&amp;nbsp;therefore refers to the &lt;b&gt;seqNumber&lt;/b&gt; of the transaction processed successfully last, with zero meaning no transaction has yet been processed successfully (the first transaction is guaranteed to have the &lt;i&gt;&lt;b&gt;seqNumber&lt;/b&gt;&lt;/i&gt; one).&lt;br&gt;&lt;br&gt;If the Naksha-Hub instance that currently runs the Observer executing a &lt;b&gt;&lt;i&gt;SubscriptionNotification&lt;/i&gt;&lt;/b&gt; crashs, another host will detect this, because there is a row-level lock at the &lt;b&gt;&lt;i&gt;SubscriptionState&lt;/i&gt;&lt;/b&gt;. This will cause another host to simply fire the exact same notification again. Handlers may detect such crashes, when they perform in-between state saves updating their personal handler-state." style="html=1;shadow=0;dashed=0;shape=mxgraph.bootstrap.rrect;rSize=5;strokeColor=#999999;strokeWidth=1;fillColor=#FFFFFF;fontColor=#6C767D;whiteSpace=wrap;align=left;verticalAlign=middle;spacingLeft=10;fontSize=14;spacing=10;container=0;" parent="1" vertex="1">
          <mxGeometry x="2031" y="2480" width="623" height="590" as="geometry" />
        </mxCell>
        <mxCell id="2efq71ZKfL60kGu9dnVV-25" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="1qYccRmLHqD2nOXxJYSw-130" target="1qYccRmLHqD2nOXxJYSw-108" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-130" value="Subscription" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#fff2cc;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="2898.5" y="2750" width="197" height="104" as="geometry" />
        </mxCell>
        <mxCell id="ocHGO5GNn9pmyrgSXm_p-15" value="+ storageId: String" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-130" vertex="1">
          <mxGeometry y="26" width="197" height="26" as="geometry" />
        </mxCell>
        <mxCell id="ocHGO5GNn9pmyrgSXm_p-16" value="+ collectionIds: List&amp;lt;String&amp;gt;?" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-130" vertex="1">
          <mxGeometry y="52" width="197" height="26" as="geometry" />
        </mxCell>
        <mxCell id="ji72XSmRw8APm09SylYo-12" value="+ status: String = ACTIVE" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-130" vertex="1">
          <mxGeometry y="78" width="197" height="26" as="geometry" />
        </mxCell>
        <mxCell id="ocHGO5GNn9pmyrgSXm_p-13" value="A subscription is a virtual collection that normally only handles &lt;i&gt;&lt;b&gt;SubscriptionNotification&lt;/b&gt;&lt;/i&gt; requests. It normally receives events generated internally by the Naksha-Observer. Naksha runs a background tasks named Naksha-Observer, that watches all physical storages, and if a physical storage has new transactions, ready for publication, it generate a &lt;b&gt;&lt;i&gt;SubscriptionNotification&lt;/i&gt;&lt;/b&gt;&amp;nbsp;and send it to all subscriptions registered for this storage (&lt;i&gt;&lt;b&gt;storageId&lt;/b&gt;&lt;/i&gt;), optionally filtered by such notifications that are impacting a sub-set of collections (&lt;i&gt;collectionIds&lt;/i&gt;).&lt;br&gt;&lt;br&gt;It is possible to suspend a subscription. For this, the property status can be set to SUSPEND. This can be done already when creating the subscriptions, to set the &lt;i&gt;&lt;b&gt;seqNumber&lt;/b&gt;&lt;/i&gt; to a specific start number and then to start the subscription. This is as well helpful to suspend subscriptions, perform some bulk changes or inserts, and finally to modifyQuery the &lt;b&gt;&lt;i&gt;seqNumber&lt;/i&gt;&lt;/b&gt; of the subscription states and then to continue the subscriptions." style="html=1;shadow=0;dashed=0;shape=mxgraph.bootstrap.rrect;rSize=5;strokeColor=#999999;strokeWidth=1;fillColor=#FFFFFF;fontColor=#6C767D;whiteSpace=wrap;align=left;verticalAlign=middle;spacingLeft=10;fontSize=14;spacing=10;" parent="1" vertex="1">
          <mxGeometry x="2704" y="2854" width="391.5" height="350" as="geometry" />
        </mxCell>
        <mxCell id="2efq71ZKfL60kGu9dnVV-24" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="ocHGO5GNn9pmyrgSXm_p-19" target="1qYccRmLHqD2nOXxJYSw-108" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="2efq71ZKfL60kGu9dnVV-26" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;" parent="1" target="1qYccRmLHqD2nOXxJYSw-130" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2944" y="2520.0833333333335" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="2997" y="2520" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="ocHGO5GNn9pmyrgSXm_p-19" value="Job" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#f8cecc;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="3544" y="2663.07" width="197" height="104" as="geometry" />
        </mxCell>
        <mxCell id="ocHGO5GNn9pmyrgSXm_p-25" value="+ state: JobState" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="ocHGO5GNn9pmyrgSXm_p-19" vertex="1">
          <mxGeometry y="26" width="197" height="26" as="geometry" />
        </mxCell>
        <mxCell id="ocHGO5GNn9pmyrgSXm_p-26" value="+ next: long" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="ocHGO5GNn9pmyrgSXm_p-19" vertex="1">
          <mxGeometry y="52" width="197" height="26" as="geometry" />
        </mxCell>
        <mxCell id="ocHGO5GNn9pmyrgSXm_p-27" value="+ active: boolean" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="ocHGO5GNn9pmyrgSXm_p-19" vertex="1">
          <mxGeometry y="78" width="197" height="26" as="geometry" />
        </mxCell>
        <mxCell id="ocHGO5GNn9pmyrgSXm_p-20" value="A job can be a one time task to be performed with a storage or it can be a regular job simply fired regularly in an interval. The purpose goes from importing or exporting data, making backups, to performing verification of data or applying machine learning algorithms (AI) to data." style="html=1;shadow=0;dashed=0;shape=mxgraph.bootstrap.rrect;rSize=5;strokeColor=#999999;strokeWidth=1;fillColor=#FFFFFF;fontColor=#6C767D;whiteSpace=wrap;align=left;verticalAlign=middle;spacingLeft=10;fontSize=14;spacing=10;" parent="1" vertex="1">
          <mxGeometry x="3544" y="2767.07" width="270" height="168" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-134" value="Extension : Plugin&amp;lt;IExtension&amp;gt;" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#fff2cc;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="3484" y="1398" width="260" height="104" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-257" value="+ host: String" style="text;strokeColor=#b85450;fillColor=#f8cecc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-134" vertex="1">
          <mxGeometry y="26" width="260" height="26" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-255" value="+ port: int" style="text;strokeColor=#b85450;fillColor=#f8cecc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-134" vertex="1">
          <mxGeometry y="52" width="260" height="26" as="geometry" />
        </mxCell>
        <mxCell id="veuHkW8nXqJATqobilVs-13" value="+ version: String" style="text;strokeColor=#b85450;fillColor=#f8cecc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-134" vertex="1">
          <mxGeometry y="78" width="260" height="26" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-246" value="Extensions are isolated child-services that are add new feature to the Naksha-Hub. They come as fat-jar and are isolated by the extension manager. They are deployed independently of the Naksha main service.&lt;br&gt;&lt;br&gt;Each extension comes with a main class that is run, monitored and managed by the Naksha extension manager.&amp;nbsp;" style="html=1;shadow=0;dashed=0;shape=mxgraph.bootstrap.rrect;rSize=5;strokeColor=#999999;strokeWidth=1;fillColor=#FFFFFF;fontColor=#6C767D;whiteSpace=wrap;align=left;verticalAlign=middle;spacingLeft=10;fontSize=14;spacing=10;" parent="1" vertex="1">
          <mxGeometry x="3484" y="1158" width="260" height="240" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-247" value="&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;IExtension&lt;br&gt;&lt;/span&gt;" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#d5e8d4;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="3484" y="1106" width="260" height="52" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-248" value="+ isHealthy() : Boolean" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-247" vertex="1">
          <mxGeometry y="26" width="260" height="26" as="geometry" />
        </mxCell>
        <mxCell id="C_nnIdQDxCc23Knee7Er-23" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="1250" y="2242" width="743" height="370.92999999999984" as="geometry" />
        </mxCell>
        <mxCell id="veuHkW8nXqJATqobilVs-16" value="XyzNamspace" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#fff2cc;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;movable=1;resizable=1;rotatable=1;deletable=1;editable=1;locked=0;connectable=1;strokeColor=#d6b656;" parent="C_nnIdQDxCc23Knee7Er-23" vertex="1">
          <mxGeometry x="380" width="363" height="442" as="geometry" />
        </mxCell>
        <mxCell id="veuHkW8nXqJATqobilVs-39" value="+ createdAt: Long" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=1;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;movable=1;resizable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="veuHkW8nXqJATqobilVs-16" vertex="1">
          <mxGeometry y="26" width="363" height="26" as="geometry" />
        </mxCell>
        <mxCell id="veuHkW8nXqJATqobilVs-40" value="+ updatedAt: Long" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=1;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;movable=1;resizable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="veuHkW8nXqJATqobilVs-16" vertex="1">
          <mxGeometry y="52" width="363" height="26" as="geometry" />
        </mxCell>
        <mxCell id="veuHkW8nXqJATqobilVs-43" value="+ txn: String" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=1;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;movable=1;resizable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="veuHkW8nXqJATqobilVs-16" vertex="1">
          <mxGeometry y="78" width="363" height="26" as="geometry" />
        </mxCell>
        <mxCell id="C_nnIdQDxCc23Knee7Er-45" value="&lt;strike&gt;+ rtus: Long&lt;/strike&gt;" style="text;strokeColor=#9673a6;fillColor=#e1d5e7;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=1;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;movable=1;resizable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="veuHkW8nXqJATqobilVs-16" vertex="1">
          <mxGeometry y="104" width="363" height="26" as="geometry" />
        </mxCell>
        <mxCell id="veuHkW8nXqJATqobilVs-44" value="+ uuid: String (GUID)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=1;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;movable=1;resizable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="veuHkW8nXqJATqobilVs-16" vertex="1">
          <mxGeometry y="130" width="363" height="26" as="geometry" />
        </mxCell>
        <mxCell id="veuHkW8nXqJATqobilVs-45" value="+ puuid: String? (GUID)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=1;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;movable=1;resizable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="veuHkW8nXqJATqobilVs-16" vertex="1">
          <mxGeometry y="156" width="363" height="26" as="geometry" />
        </mxCell>
        <mxCell id="C_nnIdQDxCc23Knee7Er-22" value="&lt;strike&gt;+ muuid: String? (GUID)&lt;/strike&gt;" style="text;strokeColor=#9673a6;fillColor=#e1d5e7;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=1;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;movable=1;resizable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="veuHkW8nXqJATqobilVs-16" vertex="1">
          <mxGeometry y="182" width="363" height="26" as="geometry" />
        </mxCell>
        <mxCell id="veuHkW8nXqJATqobilVs-47" value="+ action: String [CREATE, UPDATE, DELETE]" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=1;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;movable=1;resizable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="veuHkW8nXqJATqobilVs-16" vertex="1">
          <mxGeometry y="208" width="363" height="26" as="geometry" />
        </mxCell>
        <mxCell id="veuHkW8nXqJATqobilVs-48" value="+ version: Long" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=1;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;movable=1;resizable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="veuHkW8nXqJATqobilVs-16" vertex="1">
          <mxGeometry y="234" width="363" height="26" as="geometry" />
        </mxCell>
        <mxCell id="veuHkW8nXqJATqobilVs-49" value="+ appId: String" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=1;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;movable=1;resizable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="veuHkW8nXqJATqobilVs-16" vertex="1">
          <mxGeometry y="260" width="363" height="26" as="geometry" />
        </mxCell>
        <mxCell id="veuHkW8nXqJATqobilVs-50" value="+ author: String?" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=1;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;movable=1;resizable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="veuHkW8nXqJATqobilVs-16" vertex="1">
          <mxGeometry y="286" width="363" height="26" as="geometry" />
        </mxCell>
        <mxCell id="C_nnIdQDxCc23Knee7Er-21" value="+ authorTs: Long?" style="text;strokeColor=#9673a6;fillColor=#e1d5e7;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=1;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;movable=1;resizable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="veuHkW8nXqJATqobilVs-16" vertex="1">
          <mxGeometry y="312" width="363" height="26" as="geometry" />
        </mxCell>
        <mxCell id="veuHkW8nXqJATqobilVs-22" value="+ tags: List&amp;lt;String&amp;gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=1;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;movable=1;resizable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="veuHkW8nXqJATqobilVs-16" vertex="1">
          <mxGeometry y="338" width="363" height="26" as="geometry" />
        </mxCell>
        <mxCell id="2r80sXf8cgRXmCBXb2kK-289" value="+ grid: Int" style="text;strokeColor=#9673a6;fillColor=#e1d5e7;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=1;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;movable=1;resizable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="veuHkW8nXqJATqobilVs-16" vertex="1">
          <mxGeometry y="364" width="363" height="26" as="geometry" />
        </mxCell>
        <mxCell id="C_nnIdQDxCc23Knee7Er-46" value="&lt;strike&gt;+ crid: String&lt;/strike&gt;" style="text;strokeColor=#9673a6;fillColor=#e1d5e7;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=1;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;movable=1;resizable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="veuHkW8nXqJATqobilVs-16" vertex="1">
          <mxGeometry y="390" width="363" height="26" as="geometry" />
        </mxCell>
        <mxCell id="C_nnIdQDxCc23Knee7Er-47" value="&lt;strike&gt;+ mrid: String&lt;/strike&gt;" style="text;strokeColor=#9673a6;fillColor=#e1d5e7;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=1;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;movable=1;resizable=1;deletable=1;editable=1;locked=0;connectable=1;" parent="veuHkW8nXqJATqobilVs-16" vertex="1">
          <mxGeometry y="416" width="363" height="26" as="geometry" />
        </mxCell>
        <mxCell id="veuHkW8nXqJATqobilVs-27" value="The XYZ-Namespace is historically located in &lt;b&gt;properties &lt;/b&gt;and there referred by the key &quot;&lt;b&gt;@ns:com:here:xyz&lt;/b&gt;&quot;. All internal stored features will have this namespace attached.&lt;br&gt;&lt;br&gt;The &lt;b&gt;tags&lt;/b&gt; are used for searching, organizing and access rights restrictions of features.&lt;br&gt;&lt;br&gt;Note that the storage and collection of a feature can be extracted from the &lt;b&gt;uuid&lt;/b&gt;.&lt;br&gt;&lt;br&gt;The &lt;b&gt;uuid&lt;/b&gt; represents a unique state identifier. When given to Naksha, it will be able to load the feature from the storage just by this identifier. The same applies for the &lt;b&gt;puuid&lt;/b&gt; (previous state). Changes done to a feature are tracked in an audit-log by the storage and each feature will increment for every change done to it the version from 1 to n. Each change will provide information about the &lt;b&gt;action&lt;/b&gt; being done." style="html=1;shadow=0;dashed=0;shape=mxgraph.bootstrap.rrect;rSize=5;strokeColor=#999999;strokeWidth=1;fillColor=#FFFFFF;fontColor=#6C767D;whiteSpace=wrap;align=left;verticalAlign=middle;spacingLeft=10;fontSize=14;spacing=10;" parent="C_nnIdQDxCc23Knee7Er-23" vertex="1">
          <mxGeometry y="1" width="380" height="369.93" as="geometry" />
        </mxCell>
        <mxCell id="C_nnIdQDxCc23Knee7Er-43" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="2190" y="580" width="750" height="516" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-290" value="INaksha" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#d5e8d4;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=#82b366;" parent="C_nnIdQDxCc23Knee7Er-43" vertex="1">
          <mxGeometry y="360" width="400" height="156" as="geometry" />
        </mxCell>
        <mxCell id="2r80sXf8cgRXmCBXb2kK-9" value="+&amp;nbsp;&lt;font style=&quot;font-size: 10px;&quot;&gt;&amp;lt;&amp;lt;&amp;lt;package private&amp;gt;&amp;gt;&amp;gt;&lt;/font&gt;&amp;nbsp;getPhysicalAdminStorage() : PsqlStorage" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-290" vertex="1">
          <mxGeometry y="26" width="400" height="26" as="geometry" />
        </mxCell>
        <mxCell id="veuHkW8nXqJATqobilVs-14" value="+ getConfig() : Config" style="text;strokeColor=#b85450;fillColor=#f8cecc;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-290" vertex="1">
          <mxGeometry y="52" width="400" height="26" as="geometry" />
        </mxCell>
        <mxCell id="bkxJdcmxccUSYZqPa4WW-81" value="+ getAdminStorage(): IStorage" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-290" vertex="1">
          <mxGeometry y="78" width="400" height="26" as="geometry" />
        </mxCell>
        <mxCell id="2r80sXf8cgRXmCBXb2kK-1" value="+ getSpaceStorage(): IStorage" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-290" vertex="1">
          <mxGeometry y="104" width="400" height="26" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-293" value="+ getStorageById(storageId) : IStorage" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-290" vertex="1">
          <mxGeometry y="130" width="400" height="26" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-302" value="This is the interface to the Naksha-Hub, used by all plugins. For extensions the Naksh-Hub is a simulated one, bound via socket to a real Naksha-Hub instance, with limited access rights.&lt;br&gt;&lt;br&gt;The space-storage is an implementation where the collections map to the spaces. This can be used to send requests to the spaces and to manage the spaces as virtual collections.&lt;br&gt;&lt;br&gt;The admin storage grants access to Naksha internal collections, which stores the internal admin features in dedicated collections. This is a thin wrapper with authorization handlers added on top of the real physical admin-storage. The collections can&#39;t be modified, they are basically hard-coded, therefore this does not support any collection write requests. For example, it has a collection &quot;&lt;i&gt;naksha:spaces&lt;/i&gt;&quot; where every feature represents a space, there is a &quot;&lt;i&gt;naksha:handlers&lt;/i&gt;&quot; collection, where every feature represents a customer defined event-handler, a &quot;&lt;i&gt;nasha:storages&lt;/i&gt;&quot;, where every feature is a storage aso..&lt;br&gt;&lt;br&gt;The Hub grants access to custom storages via &lt;b style=&quot;font-style: italic;&quot;&gt;getStorageById(&lt;/b&gt;&lt;i&gt;storageId&lt;/i&gt;&lt;b style=&quot;font-style: italic;&quot;&gt;)&lt;/b&gt;. Any of these storages is a customer managed arbitrary storage, which is managed in the internal collection &quot;&lt;i&gt;naksha:storages&lt;/i&gt;&quot;. So, if a customer registers a new storage with Naksha-Hub (for example via REST API), all plugins can access this storage simply by invoking &lt;i style=&quot;&quot;&gt;&lt;b&gt;getPhysicalStorage(&lt;/b&gt;id&lt;b&gt;)&lt;/b&gt;&lt;/i&gt;.&lt;br&gt;&lt;br&gt;The package private &lt;b&gt;&lt;i&gt;getAdminStorage()&lt;/i&gt;&lt;/b&gt; method will return the internal &lt;b&gt;PsqlStorage&lt;/b&gt;." style="html=1;shadow=0;dashed=0;shape=mxgraph.bootstrap.rrect;rSize=5;strokeColor=#999999;strokeWidth=1;fillColor=#FFFFFF;fontColor=#6C767D;whiteSpace=wrap;align=left;verticalAlign=middle;spacingLeft=10;fontSize=14;spacing=10;" parent="C_nnIdQDxCc23Knee7Er-43" vertex="1">
          <mxGeometry width="750" height="360" as="geometry" />
        </mxCell>
        <mxCell id="C_nnIdQDxCc23Knee7Er-215" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="1qYccRmLHqD2nOXxJYSw-265" target="1qYccRmLHqD2nOXxJYSw-100" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9fNqtVoUOEhdQGF_z3lN-1" value="" style="group" vertex="1" connectable="0" parent="1">
          <mxGeometry x="2680" y="1500" width="374" height="104" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-96" value="Storage : Plugin&amp;lt;IStorage&amp;gt;" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#fff2cc;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=#d6b656;" parent="9fNqtVoUOEhdQGF_z3lN-1" vertex="1">
          <mxGeometry y="52" width="368.75" height="52" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-239" value="&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;IStorage&lt;/span&gt;" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#d5e8d4;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=#82b366;" parent="9fNqtVoUOEhdQGF_z3lN-1" vertex="1">
          <mxGeometry width="374" height="52" as="geometry" />
        </mxCell>
        <mxCell id="C_nnIdQDxCc23Knee7Er-169" value="-----&amp;lt;&amp;nbsp;&lt;b&gt;architecture_base.drawio&lt;/b&gt; &amp;gt;-----" style="text;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-239" vertex="1">
          <mxGeometry y="26" width="374" height="26" as="geometry" />
        </mxCell>
        <mxCell id="9fNqtVoUOEhdQGF_z3lN-2" value="A storage collection is managed by the storage. Features are organised in collections." style="html=1;shadow=0;dashed=0;shape=mxgraph.bootstrap.rrect;rSize=5;strokeColor=#999999;strokeWidth=1;fillColor=#FFFFFF;fontColor=#6C767D;whiteSpace=wrap;align=left;verticalAlign=middle;spacingLeft=10;fontSize=14;spacing=10;" vertex="1" parent="1">
          <mxGeometry x="2470" y="1950" width="320" height="70" as="geometry" />
        </mxCell>
        <mxCell id="9fNqtVoUOEhdQGF_z3lN-3" value="" style="group" vertex="1" connectable="0" parent="1">
          <mxGeometry x="2850" y="1810" width="577.9899999999998" height="127.75068105616083" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-207" value="A plugin is a configuration that can be used at runtime by Naksha. The implementation supports an API. Plugins are used to make extending the Naksha-Hub more flexible." style="html=1;shadow=0;dashed=0;shape=mxgraph.bootstrap.rrect;rSize=5;strokeColor=#999999;strokeWidth=1;fillColor=#FFFFFF;fontColor=#6C767D;whiteSpace=wrap;align=left;verticalAlign=middle;spacingLeft=10;fontSize=14;spacing=10;" parent="9fNqtVoUOEhdQGF_z3lN-3" vertex="1">
          <mxGeometry width="250.02" height="127.75" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-265" value="abstract Plugin&amp;lt;API&amp;gt;" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=#fff2cc;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=#d6b656;" parent="9fNqtVoUOEhdQGF_z3lN-3" vertex="1">
          <mxGeometry x="250.01513464991012" y="53.21861902766136" width="327.9748653500898" height="74.53206202849958" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-170" value="+ className: String" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-265" vertex="1">
          <mxGeometry y="26" width="327.9748653500898" height="24.266031014249787" as="geometry" />
        </mxCell>
        <mxCell id="1qYccRmLHqD2nOXxJYSw-169" value="+ newInstance(naksha:INaksha, plugin) = API" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="1qYccRmLHqD2nOXxJYSw-265" vertex="1">
          <mxGeometry y="50.26603101424979" width="327.9748653500898" height="24.266031014249787" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
